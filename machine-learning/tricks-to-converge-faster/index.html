<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Tricks to make Gradient Descent converge faster</title>
  <meta name="description" content="Here, we talk about a couple of tricks that you can use to optimize your gradient descent .. and make it run with fewer iterations, hence reducing the number...">

  <link href="https://fonts.googleapis.com/css?family=Lato:900|Work+Sans" rel="stylesheet">
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://yaz.in/machine-learning/tricks-to-converge-faster/">
  <link rel="alternate" type="application/rss+xml" title="Yazin Alirhayim" href="https://yazin.org/feed.xml">

  <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

  <script>
  (function(){
  	/* permanently redirect all traffic to https, keeping the path */
    var fullPath, host, ptnHost, subPath, ptnSubPath, result;

    ptnHost = /^https?:\/\/([a-z0-9.]*)[:\d]*?\/.*$/i; // localhost, google.com
    ptnSubPath = /^http:\/\/(.*?)(\/.*)$/i; // *, where "http://host/*"

    fullPath = window.location.toString();
    host = ptnHost.exec(fullPath); host = host[host.length - 1];
    subPath = ptnSubPath.exec(fullPath);
    if(subPath !== null && host != "localhost" && host != "127.0.0.1") {
      /* production URL thats using HTTP -- redirect to HTTPS sub-path */
      window.location.protocol = "https:";
    }
  })(); 
  </script>
</head>

<body>
<header> 
  <div class="links"> 
  
    
  
     
      <a class="page-link" href="/bookshelf/">My Bookshelf</a>
    
  
    
  
     
      <a class="page-link" href="/experiments/">Experiments</a>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
     
      <a class="page-link" href="/projects/">Projects</a>
    
  
    
  
    
  
    
  
    
  
  </div>
</header>


  
    <h1 class="page-title">Tricks to make Gradient Descent converge faster</h1>
  

  <div class="meta"><span>December 19, 2016</span></div>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<h3 id="trick-1-normalize-your-data">Trick #1: Normalize your data</h3>

<p>You know how you were always trying to fit in as a kid? Well, it turns out that’s good advice for our features to heed.</p>

<p>It can be proved that if your features have greatly varying ranges, then it would almost certainly take longer for gradient descent to find the local minima.</p>

<p>For example, let’s take the features below:</p>

<p>\(x_1\) = Size of the bedroom (0 - 2000 ft\(^2\))</p>

<p>\(x_2\) = Number of bedrooms (1 - 5 rooms)</p>

<p>The ideal feature would fit within the range \(-1 \le x \le +1\)</p>

<p>Just keep in mind that this is an approximate range ( \(-2 \le x \le 3 \) is fine too .. but \(-1,000 \le x \le 250\) is <strong>not</strong>)</p>

<p>Knowing what we know now, we can easily normalize \(x_1, x_2\) to fit within that range by doing:</p>

<script type="math/tex; mode=display">x_1 = \frac{\text{Size of bedroom}}{2000}</script>

<script type="math/tex; mode=display">x_2 = \frac{\text{Number of bedrooms}}{5}</script>

<p>Voila, we’re all done.</p>

<p><strong>Note:</strong> There’s another form of normalization called “Mean normalization” where you try to center the averages. Frankly, I’m feeling way too lazy to be writing about that right now .. so we’re skipping it. Read about it <a href="http://www.d.umn.edu/~deoka001/Normalization.html">here</a> if you dig that sort of thing.</p>

<h3 id="trick-2-picking-a-learning-rate-alpha">Trick #2: Picking a learning rate, \(\alpha\)</h3>

<p>We’ve discussed \(\alpha\) before, but we haven’t really talked much about how we initially decide on what value to choose.</p>

<p>Turns out, you just gotta try a bunch of values and see what works best. Rather than brute forcing every number in existence though, you can take a more visual approach.</p>

<p>Try to plot <code class="highlighter-rouge">number of iterations</code> vs. \(J(\theta)\):</p>

<p><img src="/assets/machine-learning/tricks-plot-cost-vs-iterations.png" alt="Number of iterations vs. Cost" /></p>

<p>If your \(J(\theta)\) isn’t decreasing after <em>every</em> iteration, then something isn’t right.</p>

<p>You can try the following values for \(\alpha\), starting with the smallest and moving up (until you see the values diverge):</p>

<p><code class="highlighter-rouge">0.001</code>, <code class="highlighter-rouge">0.003</code>, <code class="highlighter-rouge">0.01</code>, <code class="highlighter-rouge">0.03</code>, <code class="highlighter-rouge">0.1</code>, <code class="highlighter-rouge">0.3</code>, <code class="highlighter-rouge">1</code>
(so basically just start at <code class="highlighter-rouge">0.001</code> and keep multiplying by approx. 3)</p>

<h3 id="interesting-note">Interesting Note</h3>

<p>An interesting aside is that you can make all sorts of crazy changes to your initial data and magically conjure new features that way.</p>

<p>The action starts with a plot of the feature itself vs. the output you’re measuring:</p>

<p><img src="/assets/machine-learning/tricks-fitting.png" alt="Fitting a curve" /></p>

<p>Looking at this curve, you might think .. you know what? There kinda looks like there might be some square-root relationship going on between the \(x\) and the \(y\) .. so why don’t I just use \(\sqrt(x)\) as a feature instead of plain old \(x\) (or even in addition to the \(x\)).</p>

<p>That’s <em>totally cool</em>. Now, you’re hypothesis would look like:</p>

<script type="math/tex; mode=display">h(\theta) = \theta_0 + \theta_1 x + \theta_2 \sqrt{x}</script>




<footer> 
</footer>

<!-- Google Analytics Tracking code -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89256258-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>
